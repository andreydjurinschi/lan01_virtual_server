# Лабораторная работа №1. Виртуальный сервер

### Выполнил Джуринский Андрей. Студент группы I2302
### Дата выполнения 15.02.2025
## Цель работы

Познакомится с основами виртуализации, установкой и настройкой виртуального сервера на базе ос Debian, при помощи инструмента виртуализации **QEMU**

## Процесс выполнения работы
### 1. **Подготовка**

Для представления unix-подобного терминала уставливаю [msys32](https://www.msys2.org/).
Далее необходимо установить гипервизор **QEMU**, который позволяет запускать виртуальные машины на базе различных операционных систем.
Команда: ```pacman -S mingw-w64-ucrt-x86_64-qemu``` состоит из `pacman` - пакетного менеджера, `-S` - указания на установку пакета и `mingw-w64-ucrt-x86_64-qemu` названия самого пакета
![Qemu install](https://i.imgur.com/7tESihK.png)
 
Затем при помощи wget утилиты загружаю установочный образ ОС Debian 

![Debian install](https://i.imgur.com/Dn1UhuA.png)

> **Вопрос 1:** Каким образом можно скачать файл в консоли при помощи утилиты wget?

**При помощи утилиты wget и вставки URL адреса файла мы можем установить его в текущую директорию, Пример:** ``wget https://cdimage.debian.org/debian-cd/current/amd64/iso-dvd/debian-12.9.0-amd64-DVD-1.iso``
### 2. **Выполнение**

Создаю папку `lab01`, в ней  папку `dvd` и `readme.md` файл.
![Desc](https://i.imgur.com/mtt8ZpQ.png)
![Desc readme](https://i.imgur.com/CHCTb7a.png)
В папку dvd при помощи утилиты `mv` помещаю образ дистрибутива и при помощи той же утилиты переименовываю его:
![move debian ISO file](https://i.imgur.com/4t6iVQr.png)
далее по заданию создаем образ диска для ВМ размером **8 гб** и с форматом `qcow2`, при помощи команды `qemu-img create -f qcow2 debian.qcow2 8G`. 
`qemu-img` - утилита для работы с образами диском, `create -f qcow2` - команда для создания нового диска с заданным форматом, позволяющим увеличивать размера файла по мере его использования, `debian.qcow2` - название файла и `8G` - его размер

> **Вопрос 6:** Сколько места занимает установленная вами ОС (виртуальный диск) на хостовой машине?

**Установленая ОС занимает 8 ГБ места, однако фактический размер будет намного меньше до того момента, пока я не начну далее устанавливать доп пакеты для выполнения лаб работы, в этом и прелесть формата qcow2, тк он позволяет динамически выделять место для виртуального диска и увеличивать его по мере работы**

#### Далее подробно поговорим о процессе установки ОС Debian на виртуальную машину:
Команда `qemu-system-x86_64 -hda debian.qcow2 -cdrom dvd/debian.iso -boot d -m 2G`

`-hda debian.qcow2` указывает на использование образа диска в качестве основного для виртуальной машины

`-cdrom dvd/debian.iso` - указывает на ISO образ диска ОС, который будет смонтирован в качестве устройства виртуальной машины

`boot d` - указывает, что виртуальная машина должна загрузиться с диска описанного выше и будет использоваться как основное устройство для загрузки

параметры при установки указывались из материалов лаб работы 
![Downloading](https://i.imgur.com/tummHXQ.png)

Процесс установки занимал приличное врем, переодически выдавая всплывающие окна, например:
![label1](https://i.imgur.com/OWvglVA.png)
здесь инсталлятор запрашивал провести сканирования на наличие доп источников, которые могу содержать доп пакеты, однако образ у меня только один, соответственно пропускаем данный шаг

![label2](https://i.imgur.com/j5w3TgR.png)
На данном этапе установщик запросил использовать сетевое зеркало для установки доп пакетов, которые отсутствуют на моем ISO образе, с данным шагом я уже согласился, тк не хотел рисковать

После завершения загрузки исполняем команду из отчета по лабораторной работе

`qemu-system-x86_64 -hda debian.qcow2 -m 2G -smp 2 \ -device e1000,netdev=net0 -netdev user,id=net0,hostfwd=tcp::1080-:80,hostfwd=tcp::1022-:22`

команда позволяет запустить эмулятор qemu указывая на наш виртуальный диск, так же задает важные параметры по типу добавления виртуального интерыейса `-device e1000,netdev=net0`, `hostfwd=tcp::1080-:80` для получения доступа к виртуальному серверу с хоста (apache в нашем случае)

![waiting](https://i.imgur.com/d0sYMTU.png)

после выполнения команды ждем прогрузку qemu,
на данном этапе мы подключаемся к виртуальной машине **qemu** с доступом в ос **debian**. Аосле запуска входим в систему с заданными паролем и юзернеймом и подключаемся сразу к root пользователю. Тк при установке debian я пропустил этап создания пароля для рут пользователя, пароль остается таким же как и у созданного user:
![vhod](https://i.imgur.com/lLxiyXK.png)

Далее устанавливаю необходимые пакеты:

`apt update -y` 

`apt install -y apache2 php libapache2-mod-php php-mysql mariadb-server mariadb-client unzip`

> Какое назначение установленных пакетов?

`apache2` - сервер для размещения веб сайтов, обслуживая http запросы и предоставляя ответы

`php` - ЯП, предназначенный для выполнения и создания серверной логики веб приложений

`libapache2-mod-php` - библиотека, позволяющая `apache` обрабатывать пхп скрипты

`php-mysql` - библиотека, позволяющая работать  php с mysql

`mariadb-server` - СУБД для хранения и управления базой данных

`mariadb-client` - пакет, необходимый для работы с mariadb через командную строку

`unzip` - пакет, используемый для распаковки файлов
